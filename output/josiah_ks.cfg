# Install

install
url --url=http://192.168.1.200/repo/centos/6/os/x86_64/
lang en_US.UTF-8
keyboard us
reboot
# Network
network --onboot yes --device eth0 --bootproto static --ip 192.168.1.50 --netmask 255.255.255.0 --gateway 192.168.1.1 --noipv6 --nameserver 208.67.222.222,8.8.8.8 --hostname josiah

## Services

rootpw  --iscrypted $6$XweJyB1g$RHM7dwKPNfcd21tAy2TvXI.EDF/gh75/LNkhLFcxGEteFKg7r7ams7N/hxWlXEERzvH5jXt4gdiuSUBPDflxX/
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --permissive
timezone --utc America/New_York

user --name ansible --password=$6$7swkaSIV$5HGmYEz69H.Z8/JD0kM9iGNOe0AICId03jQvbemuyXNVxsgpBXxImp25ol7xYQKkCN3oWO8gsMqGjk7YxT3LW/ --iscrypted --uid=600 --shell=/bin/bash 
# Partitions

# "sdb" is a localism, most places will use sda.
clearpart --initlabel --all --drives=sdb,sdc
zerombr

bootloader --location=mbr --driveorder=sdb --append="crashkernel=auto rhgb quiet"

part /boot --fstype=ext4 --size=2000
part pv.01 --grow --size=1
volgroup vg_root --pesize=4096 pv.01
logvol / --fstype=ext4 --name=lv_root --vgname=vg_root --size=8192
logvol /home --fstype=ext4 --name=lv_home --vgname=vg_root --size=4096
logvol /var --fstype=ext4 --name=lv_var --vgname=vg_root --size=4096
logvol /var/log --fstype=ext4 --name=lv_var_log --vgname=vg_root --size=4096
logvol /var/log/audit --fstype=ext4 --name=lv_var_log_audit --vgname=vg_root --size=4096
logvol /tmp --fstype=ext4 --name=lv_tmp --vgname=vg_root --size=8192
logvol swap --name=lv_swap --vgname=vg_root --size=8192

part pv.02 --grow --size=1 --ondrive=sdc
volgroup vg_opt pv.02
logvol /opt --name=lv_opt --vgname=vg_opt --size=1 --grow

part pv.03 --grow --size=1 --ondrive=sdd
volgroup vg_storage pv.03
logvol /opt/storage --name=lv_storage --vgnamevg_storage --size=1 --grow

## Packages

%packages --nobase --ignoremissing
@base
@core
@additional-devel
@debugging
@basic-desktop
@desktop-debugging
@desktop-platform
@desktop-platform-devel
@development
@directory-client
@fonts
@general-desktop
@graphical-admin-tools
@graphics
@input-methods
@internet-browser
@legacy-x
@network-file-system-client
@performance
@perl-runtime
@print-client
@remote-desktop-clients
@server-platform
@server-platform-devel
@server-policy
@tex
@technical-writing
@virtualization
@virtualization-client
@virtualization-platform
@workstation-policy
@x11
libgcrypt-devel
libXinerama-devel
openmotif-devel
libXmu-devel
xorg-x11-proto-devel
startup-notification-devel
libgnomeui-devel
libbonobo-devel
libXau-devel
libXrandr-devel
popt-devel
gnome-python2-desktop
libdrm-devel
libxslt-devel
libglade2-devel
gnutls-devel
mtools
pax
python-dmidecode
oddjob
wodim
sgpio
genisoimage
device-mapper-persistent-data
systemtap-client
desktop-file-utils
ant
rpmdevtools
jpackage-utils
rpmlint
samba-winbind
pam_krb5
krb5-workstation
netpbm-progs
openmotif
libXmu
libXp
perl-DBD-SQLite

openssh-clients
rpm
yum
unzip
mlocate

-yum-updateonboot
-telnet-server
-rsh-server
%end

## Pre
%pre

%end

## Post
%post
mkdir /home/ansible/.ssh
wget http://192.168.1.200/ks/files/ansible_authorized_keys -O /home/ansible/.ssh/authorized_keys
chmod 600 /home/ansible/.ssh/authorized_keys
chown -R ansible:ansible /home/ansible

echo "ansible ALL=(ALL) ALL" >> /etc/sudoers.d/01_ansible

%end

